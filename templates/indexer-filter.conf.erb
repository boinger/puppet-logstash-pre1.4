
# mind that we're now using our own up patterns_dir which is managed by puppet

filter {
 #  grok {
 #    patterns_dir	=> [ "/etc/logstash/grok_patterns" ]
 #    match 		=> [ "wtf" ]
 #    type		=> "syslog"
 #    add_tag		=> 'wtf'
 #    add_field		=> [ "wtf", "%{@message}" ]
 #    break_on_match	=> true
 #    named_captures_only => true
 # } 
  grep {
    negate => true
    match  => [ "@message", "dhclient" ]
  }

  kv {
    field_split => "^"
    value_split => ":"
    type        => "applog"
  }

  grok {
    patterns_dir        => [ "/etc/logstash/grok_patterns" ]
    type                => "syslog"
    pattern             => "%{SYSLOGLINE}"
    break_on_match      => true
    #named_captures_only => true
  }
  grok {
    patterns_dir        => [ "/etc/logstash/grok_patterns" ]
    type                => "apache-access"
    pattern             => "%{COMBINEDAPACHELOG}"
    break_on_match      => true
    named_captures_only => true
  }

  date {
    type => "syslog"
    match => [ "logdate", "MMM dd YYY HH:mm:ss", "MMM  d YYY HH:mm:ss", "ISO8601" ]
  }
  date {
    type	=> "apache-access"
    match => [ "logdate", "dd/MMM/yyyy:HH:mm:ss Z" ]
  }
}
