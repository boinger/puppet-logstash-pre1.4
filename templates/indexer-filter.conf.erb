
# mind that we're now using our own patterns_dir which is managed by puppet

filter {

  # http://logstash.net/docs/1.1.13/filters/grok
  # grok {
  #    type              => "syslog"
  #    match             => [ "wtf" ]
  #    patterns_dir      => [ "/etc/logstash/grok_patterns" ]
  #    pattern           => ??????
  #    add_tag           => 'wtf'
  #    add_field         => [ "wtf", "%{@message}" ]
  #    break_on_match    => true
  #    named_captures_only => true
  # }

  # grep notes?
  # kv notes?

  grep {
    match  => [ "@message", "dhclient" ]
    negate => true
  }

  kv {
    type        => "applog"
    field_split => "^"
    value_split => ":"
  }

  # SYSLOGBASE2 (?:%{SYSLOGTIMESTAMP:timestamp}|%{TIMESTAMP_ISO8601:timestamp8601}) (?:%{SYSLOGFACILITY} )?%{SYSLOGHOST:logsource} %{SYSLOGPROG}:
  grok {
    match => ["@source_path", "/var/log/messages"]
    patterns_dir => ["/etc/logstash/grok_patterns"]
    pattern => "%{SYSLOGLINE}"
    add_field => [ "syslog_timestamp", "%{timestamp}" ]
    add_field => [ "syslog_timestamp8601", "%{timestamp8601}" ]
    add_field => [ "syslog_facility", "%{facility}" ]
    add_field => [ "syslog_priority", "%{priority}" ]
    add_field => [ "syslog_logsource", "%{logsource}" ]
    add_field => [ "program", "%{program}" ]
    add_field => [ "pid", "%{pid}" ]
    add_tag => ["fake_tag", "%{program}", "%{facility}"]
  }

 # grok {
 #      type => "syslog"
 #      pattern => [ "<%{POSINT:syslog_pri}>%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}" ]
 #      add_field => [ "received_at", "%{@timestamp}" ]
 #      add_field => [ "received_from", "%{@source_host}" ]
 #  }

  # grok {
  #   type                => "syslog"
  #   patterns_dir        => [ "/etc/logstash/grok_patterns" ]
  #   pattern             => "%{SYSLOGLINE}"
  #   break_on_match      => true
  #   #named_captures_only => true
  # }

  # grok {
  #   type                => "apache-access"
  #   patterns_dir        => [ "/etc/logstash/grok_patterns" ]
  #   pattern             => "%{COMBINEDAPACHELOG}"
  #   break_on_match      => true
  #   named_captures_only => true
  # }

  # date {
  #   type => "syslog"
  #   match => [ "logdate", "MMM dd YYY HH:mm:ss", "MMM  d YYY HH:mm:ss", "ISO8601" ]
  # }
  # date {
  #   type => "apache-access"
  #   match => [ "logdate", "dd/MMM/yyyy:HH:mm:ss Z" ]
  # }
}
